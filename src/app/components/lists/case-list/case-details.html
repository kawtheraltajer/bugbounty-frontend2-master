<ng-container *ngIf="!isLoading">
  <vt-header>
    <div slot="start">
      <div matRipple (click)="app.routerBack()"
        class="flex flex-row items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:text-step-400">
        <ion-icon class="text-2xl" name="arrow-back-outline"></ion-icon>
      </div>
    </div>
    <div slot="middle">
      <!--{{'Court.Cases.Details'|translate}}--> <span *ngIf='Case?.CaseNo'>{{Case?.CaseNo}} -</span>
      {{Case?.client?.full_name}}
    </div>
    <div slot="end">
      <ion-menu-button></ion-menu-button>
    </div>
  </vt-header>


  <div class="relative flex flex-col flex-auto w-full h-full overflow-y-auto">

    <div class="w-full">
      <ion-segment class="border-b" [(ngModel)]="segment">
        <ion-segment-button value="0">
          {{'Court.Cases.Details'|translate}}
        </ion-segment-button>
        <ion-segment-button value="1">
          {{'Court.Cases.Oponent'|translate}}
        </ion-segment-button>
        <ion-segment-button value="2"
          *ngIf="('Fees:READ:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
          {{'Court.Cases.Fees'|translate}}
        </ion-segment-button>
        <ion-segment-button value="3">
          {{'Court.Cases.Documents'|translate}}
        </ion-segment-button>
        <ion-segment-button value="4" *ngIf="Case.RelationType != 'Execuation'">
          {{'Court.Cases.Sessions'|translate}}
        </ion-segment-button>
        <ion-segment-button value="4" *ngIf="Case.RelationType == 'Execuation'">
          {{'Court.Cases.Case-requests'|translate}}
        </ion-segment-button>
        <ion-segment-button value="5">
          {{'Court.Cases.Related_cases'|translate}}
        </ion-segment-button>
        <ion-segment-button value="6"
          *ngIf="('Claim:READ:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
          {{'Court.Cases.Claims_collection'|translate}}
        </ion-segment-button>
        <ion-segment-button value="7"
          *ngIf="('Task:READ:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
          {{'Court.Cases.Task'|translate}}
        </ion-segment-button>
        <ion-segment-button value="8"
          *ngIf="('Charge:READ:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
          {{'Court.Cases.Charges'|translate}}
        </ion-segment-button>
      </ion-segment>
    </div>

    <ng-container *ngIf="segment == 0">
      <div style="display: -webkit-box;display: -webkit-inline-box;">
        <div class="relative flex flex-row  justify-center w-full p-2 border-b border-step-100 bg-background">
          <div class="flex-1 items-start">
            <mat-slide-toggle color="primary" (change)="isChecked($event)" [(ngModel)]="isEditMode"
              *ngIf="('Case:UPDATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
              {{'Operations.EditMode'|translate}}
            </mat-slide-toggle>
          </div>
          <div class="flex-12 items-start">
            <button
              *ngIf="isEditMode && ('Case:UPDATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)"
              mat-flat-button color="accent" (click)="updateClient()">{{'Operations.Update'|translate}}</button>
          </div>
        </div>
      </div>
      <div class="relative flex flex-col flex-auto w-full h-full pb-8 overflow-y-auto">
        <div class="relative flex flex-col w-full ">
          <form [formGroup]="addForm">
            <div class="flex flex-col w-full lg:flex-row">
              <!--Col start-->
              <div class="flex flex-col lg:flex-row lg:w-1/2 border-ie ">
                <div class="flex flex-col flex-1 border-is">
                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Client'|translate}} </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case.client?.full_name}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="clientID">
                        <mat-option>
                          <ngx-mat-select-search (keyup)="filterClients($event)"
                            placeholderLabel="ابحث عن موكل" [formControl]="clientFilterCtrl"
                            noEntriesFoundLabel="لا يوجد">
                            <mat-icon (click)="clearSelectionClients()" class="mx-auto" aria-label="clear"
                              ngxMatSelectSearchClear>close</mat-icon>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let client of clientFilter" [value]="client.id">{{client?.full_name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <div class="validation-errors">
                      <ng-container *ngFor="let validation of validation_messages.clientID">
                        <div class="text-red-600 text-end"
                          *ngIf="addForm.get('clientID').hasError(validation.type) && (addForm.get('clientID').dirty || addForm.get('clientID').touched)">
                          {{ validation.message |translate }}
                        </div>
                      </ng-container>
                    </div>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Case_type'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{ lang.selectedLang=='en'? Case.type?.name_en:Case.type?.name_ar| titlecase}}
                      <span *ngIf="Case.type?.type"> - {{'Court.Cases.Case-type.Case_Types_Type.'
                        +Case.type?.type|translate}}</span>
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="typeID">
                        <mat-option>
                          <ngx-mat-select-search (keyup)="filterCaseType($event)" placeholderLabel="ابحث عن نوع قضية"
                            [formControl]="CaseTypeFilterCtrl" noEntriesFoundLabel="لا يوجد">
                            <mat-icon (click)="clearSelectionCaseType()" class="mx-auto" aria-label="clear"
                              ngxMatSelectSearchClear>close</mat-icon>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option (click)="AddNewCaeType()"
                          *ngIf="('CaseType:CREATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE'|permission)">
                          {{'Court.Cases.Case-type.Add'|translate}} +
                        </mat-option>
                        <mat-option *ngFor="let type of CaseTypeFilter" [value]="type.id">
                          {{ lang.selectedLang=='en'? type.name_en:type.name_ar| titlecase}}
                          <span *ngIf="type?.type"> - {{'Court.Cases.Case-type.Case_Types_Type.'
                            +type?.type|translate}}</span>
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <div class="validation-errors" *ngIf="isEditMode">
                      <ng-container *ngFor="let validation of validation_messages.typeID">
                        <div class="text-red-600 text-end"
                          *ngIf="addForm.get('typeID').hasError(validation.type) && (addForm.get('typeID').dirty || addForm.get('typeID').touched)">
                          {{ validation.message |translate }}
                        </div>
                      </ng-container>
                    </div>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Level'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      <span *ngIf="Case?.RelationType">{{'Court.Cases.RelationType.' +
                        Case?.RelationType|translate}}</span>
                    </div>

                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="RelationType">
                        <mat-option value="level 1">
                          {{'Court.Cases.RelationType.level 1'|translate}}
                        </mat-option>
                        <mat-option value="Appeal">
                          {{'Court.Cases.RelationType.Appeal'|translate}}
                        </mat-option>
                        <mat-option value="Discrimination">
                          {{'Court.Cases.RelationType.Discrimination'|translate}}
                        </mat-option>
                        <mat-option value="Execuation">
                          {{'Court.Cases.RelationType.Execuation'|translate}}
                        </mat-option>
                        <mat-option value="Similar">
                          {{'Court.Cases.RelationType.Similar'|translate}}

                        </mat-option>


                      </mat-select>
                    </mat-form-field>

                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Case_status.Case_status'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2" #status>
                      <span *ngIf="Case?.status">{{("Court.Cases.Form.Case_status."+Case?.status)|translate}} </span>
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="status" #status>
                        <mat-option value="InProgress">
                          {{'Court.Cases.Form.Case_status.InProgress'|translate}}
                        </mat-option>
                        <mat-option value="Judged">
                          {{'Court.Cases.Form.Case_status.Judged'|translate}}
                        </mat-option>
                        <mat-option value="Closed">
                          {{'Court.Cases.Form.Case_status.Closed'|translate}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b"
                    *ngIf="('Case:READ:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Comment'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                      {{Case?.comment}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <input matInput type="text" formControlName="comment">
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.caseRepresentative.caseRepresentative'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                      <span
                        *ngIf="Case?.caseRepresentative">{{("Court.Cases.Form.caseRepresentative."+Case?.caseRepresentative)|translate}}
                      </span>
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="caseRepresentative">
                        <mat-option>
                          <ngx-mat-select-search (keyup)="filterCaseRepresentative($event)"
                            placeholderLabel="ابحث عن صفة" [formControl]="CaseRepresentativeFilterCtrl"
                            noEntriesFoundLabel="لا يوجد">
                            <mat-icon (click)="clearSelectionCaseRepresentative()" class="mx-auto" aria-label="clear"
                              ngxMatSelectSearchClear>close</mat-icon>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let representative of CaseRepresentativeFilter" [value]="representative.name">
                          {{'Court.Cases.Form.caseRepresentative.' + representative.name |translate}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b" *ngIf="show">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.JudgedAt'|translate}} <span style="color: red;" *ngIf="isEditMode">*</span>
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                      {{Case?.JudgedAt | date:'dd/MM/yyyy'}}
                    </div>
                    <mat-form-field appearance="standard" class="w-full" *ngIf="isEditMode"
                      class="flex items-center flex-1 px-2">
                      <input matInput formControlName="JudgedAt" [matDatepicker]="picker">
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                    <div class="validation-errors" *ngIf="isEditMode">
                      <ng-container *ngFor="let validation of validation_messages.JudgedAt">
                        <div class="text-red-600 text-end"
                          *ngIf="addForm.get('JudgedAt').hasError(validation.type) && (addForm.get('JudgedAt').dirty || addForm.get('JudgedAt').touched)">
                          {{ validation.message |translate }}
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>
              <!--Col end-->
              <!--Col start-->
              <div class="flex flex-col lg:flex-row lg:w-1/2 border-ie ">
                <div class="flex flex-col flex-1 border-is">
                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.File_no'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case?.internalFile_no}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <input matInput type="text" formControlName="internalFile_no" placeholder="">
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.CaseNo'|translate}}
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                      {{Case?.CaseNo}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <input matInput type="text" formControlName="CaseNo">
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Related_Company'|translate}} </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case.company?.full_name}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="companyID">
                        <mat-option *ngFor="let company of companies" [value]="company.id">{{company?.full_name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Representative'|translate}} </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case.representative?.user?.first_name}}{{" "}} {{Case.representative?.user?.last_name}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="representativeID">
                        <mat-option *ngFor="let representative of representatives" [value]="representative.id">
                          {{representative.user?.first_name}}{{" "}} {{representative.user?.last_name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Court'|translate}} </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case.court?.name}}
                    </div>
                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="courtID">
                        <mat-option>
                          <ngx-mat-select-search (keyup)="filterCourt($event)" placeholderLabel="ابحث عن محكمة"
                            [formControl]="CourtFilterCtrl" noEntriesFoundLabel="لا يوجد">
                            <mat-icon (click)="clearSelectionCourt()" class="mx-auto" aria-label="clear"
                              ngxMatSelectSearchClear>close</mat-icon>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let court of CourtFilter" [value]="court.id">{{court?.name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Court_Room'|translate}} </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                      {{Case.courtRoomID}}
                    </div>


                    <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                      <mat-select formControlName="courtRoomID">
                        <mat-option>
                          <ngx-mat-select-search (keyup)="FilterCourtRoom($event)" placeholderLabel="ابحث عن رقم المحكمة"
                            [formControl]="courtRoomsFilterCtrl" noEntriesFoundLabel="لا يوجد">
                            <mat-icon (click)="clearSelectionCourtRoom()" class="mx-auto" aria-label="clear"
                              ngxMatSelectSearchClear>close</mat-icon>
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let courtRoom of courtRoomsFilter" [value]="courtRoom.id">
                          {{courtRoom.title}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="flex flex-row items-center h-12 border-b" *ngIf="show">
                    <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                      {{'Court.Cases.Form.Adjudge'|translate}} <span style="color: red;" *ngIf="isEditMode">*</span>
                    </div>
                    <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                      {{Case?.Adjudge}}
                    </div>
                    <mat-form-field appearance="standard" class="w-full" *ngIf="isEditMode"
                      class="flex items-center flex-1 px-2">
                      <input matInput type="text" formControlName="Adjudge">
                    </mat-form-field>
                    <div class="validation-errors" *ngIf="isEditMode">
                      <ng-container *ngFor="let validation of validation_messages.Adjudge">
                        <div class="text-red-600 text-end"
                          *ngIf="addForm.get('Adjudge').hasError(validation.type) && (addForm.get('Adjudge').dirty || addForm.get('Adjudge').touched)">
                          {{ validation.message |translate }}
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>
              <!--Col end-->

            </div>
          </form>
        </div>
        <div class="flex-12 items-start p-2 text-gray-500" *ngIf="Case.Last_updated_User">
          {{'Operations.LastUpdated'|translate}}: {{Case?.Last_updated_User}} {{Case?.Last_updated| date:'dd/MM/yyyy hh:mm a'}}
        </div>
      </div>

    </ng-container>
    <ng-container *ngIf="segment == 1">
      <div style="display: -webkit-box;display: -webkit-inline-box;"
        *ngIf="('Opponent:UPDATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
        <div class="relative flex flex-row  justify-center w-full p-2 border-b border-step-100 bg-background">
          <div class="flex-1 items-start">
            <mat-slide-toggle color="primary" [(ngModel)]="isEditMode">
              {{'Operations.EditMode'|translate}}
            </mat-slide-toggle>
          </div>
          <div class="flex-12 items-start">
            <button *ngIf="isEditMode" mat-flat-button color="accent"
              (click)="updateClient()">{{'Operations.Update'|translate}}</button>
          </div>
        </div>
      </div>
      <div class="relative flex flex-col flex-auto w-full h-full pb-8 overflow-y-auto">
        <form [formGroup]="addForm">
          <div class="flex flex-col w-full lg:flex-row">
            <!--Col start-->
            <div class="flex flex-col lg:flex-row lg:w-1/2 border-ie ">
              <div class="flex flex-col flex-1 border-is">
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.full_name'|translate}} <span style="color: red;" *ngIf="isEditMode">*</span>
                  </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.name}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_name">
                  </mat-form-field>
                  <div class="validation-errors" *ngIf="isEditMode">
                    <ng-container *ngFor="let validation of validation_messages.Opponent_name">
                      <div class="text-red-600 text-end"
                        *ngIf="addForm.get('Opponent_name').hasError(validation.type) && (addForm.get('Opponent_name').dirty || addForm.get('Opponent_name').touched)">
                        {{ validation.message |translate }}
                      </div>
                    </ng-container>
                  </div>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.mobile1'|translate}}</div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.main_mobile}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_Mobile1">
                  </mat-form-field>
                  <div class="validation-errors" *ngIf="isEditMode">
                    <ng-container *ngFor="let validation of validation_messages?.Opponent_Mobile1">
                      <div class="text-red-600 text-end"
                        *ngIf="addForm.get('Opponent_Mobile1').hasError(validation.type) && (addForm.get('Opponent_Mobile1').dirty || addForm.get('Opponent_Mobile1').touched)">
                        {{ validation.message |translate }}
                      </div>
                    </ng-container>
                  </div>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.mobile2'|translate}} </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.secondry_mobile}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_Mobile2">
                  </mat-form-field>
                  <div class="validation-errors" *ngIf="isEditMode">
                    <ng-container *ngFor="let validation of validation_messages?.Opponent_Mobile2">
                      <div class="text-red-600 text-end"
                        *ngIf="addForm.get('Opponent_Mobile2').hasError(validation.type) && (addForm.get('Opponent_Mobile2').dirty || addForm.get('Opponent_Mobile2').touched)">
                        {{ validation.message |translate }}
                      </div>
                    </ng-container>
                  </div>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.address'|translate}}
                  </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                    {{Case?.opponent?.address}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_Address">
                  </mat-form-field>
                </div>
              </div>
            </div>
            <!--Col end-->
            <!--Col start-->
            <div class="flex flex-col lg:flex-row lg:w-1/2 border-ie ">
              <div class="flex flex-col flex-1 border-is">
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.CPR'|translate}}
                  </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.cpr}} </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="number" formControlName="Opponent_CPR">
                  </mat-form-field>
                  <div class="validation-errors" *ngIf="isEditMode">
                    <ng-container *ngFor="let validation of validation_messages?.Opponent_CPR">
                      <div class="text-red-600 text-end"
                        *ngIf="addForm.get('Opponent_CPR').hasError(validation.type) && (addForm.get('Opponent_CPR').dirty || addForm.get('Opponent_CPR').touched)">
                        {{ validation.message |translate }}
                      </div>
                    </ng-container>
                  </div>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.nationality'|translate}} </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.nationality}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_Nationality">
                  </mat-form-field>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.email'|translate}}
                  </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-1 px-2">
                    {{Case?.opponent?.email}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="email" formControlName="Opponent_Email">
                  </mat-form-field>
                </div>
                <div class="flex flex-row items-center h-12 border-b">
                  <div class="flex items-center w-24 h-full p-2 border-ie bg-step-50 pis-2">
                    {{'Court.Cases.Form.Organization'|translate}}
                  </div>
                  <div *ngIf="!isEditMode" class="flex items-center flex-12 px-2">
                    {{Case?.opponent?.organization}}
                  </div>
                  <mat-form-field *ngIf="isEditMode" class="flex items-center flex-1 px-2">
                    <input matInput type="text" formControlName="Opponent_Organization">
                  </mat-form-field>
                </div>
              </div>
            </div>
            <!--Col end-->
          </div>
        </form>
        <div class="flex-12 items-start p-2 text-gray-500" *ngIf="Case.Last_updated_User">
          {{'Operations.LastUpdated'|translate}}: {{Case?.Last_updated_User}} {{Case?.Last_updated| date:'dd/MM/yyyy hh:mm a'}}
        </div>
      </div>
    </ng-container>

    <ng-container *ngIf="segment == 2">
      <div style="display: -webkit-box;display: -webkit-inline-box;">
        <fees-list [CaseID]="CaseID" [ClientID]="Case?.clientID"></fees-list>
      </div>
    </ng-container>
    <ng-container *ngIf="segment == 3">
      <document-list [caseID]="CaseID" [FromCase]="true"></document-list>
    </ng-container>
    <ng-container *ngIf="(segment == 4) && (Case.RelationType != 'Execuation')">
      <div style="display: -webkit-box;display: -webkit-inline-box;">
        <div class="relative flex flex-row  justify-center w-full p-2 border-b border-step-100 bg-background">
          <div class="flex-1 items-start">

            <div class="relative flex flex-row justify-center w-full p-2 border-b border-step-100 bg-background">
              <div class="relative flex flex-1 h-10 border rounded-lg  lg:flex-none lg:w-1/3 bg-toolbar-background ">
                <input class="w-full h-full pl-12 pr-1 text-sm bg-backeground text-step-900 focus:outline-none"
                  type="search" name="search" placeholder="        {{'Operations.Search'|translate}} 
              " [(ngModel)]="searchTerm" #search (keyup)="clearSearchList()">
                <mat-icon (click)="getallSessions()" *ngIf="searchTerm" class="mx-auto cursor-pointer p-2"
                  aria-label="clear" ngxMatSelectSearchClear>close</mat-icon>
              </div>
              <div class="flex-1 ">

                <ion-button color="primary" (click)="searchforSession()">بحث</ion-button>
              </div>
              <div class="flex-1">

              </div>

              <div
                class="relative flex items-center justify-center h-10 p-2 mx-2 border rounded-lg cursor-pointer flex-12 bg-toolbar-background hover:bg-step-50 "
                (click)="addsession()"
                *ngIf="('Session:CREATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
                <ion-icon name="add"></ion-icon>
                {{'Court.Session.Add'|translate}}

              </div>
            </div>
          </div>



        </div>
      </div>
      <table mat-table [dataSource]="pageData" matSort class="z-10 w-full overflow-y-auto bg-background text-step-600">
        <!-- Checkbox Column -->

        <ng-container matColumnDef="ID">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.ID'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">
            {{element.id}} </td>
        </ng-container>
        <ng-container matColumnDef="Ref_No">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Ref_No'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">
            {{element.reference_no}} </td>
        </ng-container>
        <ng-container matColumnDef="Case">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Case'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">
            {{element.case?.CaseNo}}{{"-"}}{{element.case?.client?.full_name}}


          </td>
        </ng-container>


        <ng-container matColumnDef="Status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Status'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">

            {{("Court.Session.Form.status."+element?.status)|translate}}
          </td>
        </ng-container>
        <ng-container matColumnDef="Session_Date">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Session_Date'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">

            {{element.date |date : 'dd/MM/YYYY' }}

          </td>
        </ng-container>
        <ng-container matColumnDef="Lawyer_Name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Lawyer_Name'|translate}}

            </p>
          </th>
          <td mat-cell *matCellDef="let element">

            {{element.representative?.user.first_name}}{{" "}}{{element.representative?.user.last_name}}

          </td>
        </ng-container>
        <ng-container matColumnDef="Delay_Reason">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Delay_Reason'|translate}}
            </p>
          </th>
          <td mat-cell *matCellDef="let element">

            {{element.DelayReson?.name_ar}}
          </td>
        </ng-container>
        <ng-container matColumnDef="Upcoming_Session">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Upcoming_Session'|translate}}
            </p>
          </th>
          <td mat-cell *matCellDef="let element">



            {{element.next_session_date |date : 'dd/MM/YYYY'}}
          </td>
        </ng-container>


        <ng-container matColumnDef="Action">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <p class="w-full text-center">
              {{'Court.Session.List.Action'|translate}}


            </p>
          </th>
          <td mat-cell *matCellDef="let row; let i=index;">
            <button mat-icon-button color="accent" (click)="detailsSesstion(row)"
              *ngIf="('Session:UPDATE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)">
              <mat-icon class="mx-auto" aria-label="Edit">edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteSession(row)"
              *ngIf="('Session:DELETE:MANAGE,SuperAdminAccess:MANAGE,AdminAccess:MANAGE,AdminSupportAccess:MANAGE,SLawyerAccess:MANAGE,LawyerAccess:MANAGE'|permission)"
              [matTooltip]="'Operations.Delete'|translate">
              <mat-icon class="mx-auto" aria-label="Delete">delete</mat-icon>
            </button>
          </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="getDisplayedColumns(); sticky: true" class="border-b"></tr>
        <tr mat-row *matRowDef="let row; columns: getDisplayedColumns();"
          class="border-b cursor-pointer border-step-100 hover:bg-step-50">
        <tr class="mat-row" *matNoDataRow>
          <ng-template #NoRoles>
            <td class="text-2xl text-center mat-cell" colspan="5">There are no roles.
            </td>
          </ng-template>

        </tr>
      </table>
      <mat-paginator ##CaseTablePaginator [length]="dataCount" [pageSize]="itemsPerPage" [pageSizeOptions]="[5,10,20]"
        (page)="pageEvent($event)"
        class="sticky bottom-0 w-full bg-gray-100 border-t border-b border-step-100 mat-paginator-sticky"
        showFirstLastButtons>
      </mat-paginator>
    </ng-container>
    <ng-container *ngIf="(segment == 4) && (Case.RelationType == 'Execuation')">
      <case-requests-list [caseID]="CaseID"></case-requests-list>
    </ng-container>
    <ng-container *ngIf="segment == 5">
      <ion-content>
        <case-list [RelatedCaseID]="this.CaseID" [IsRelated]="true"></case-list>
      </ion-content>
    </ng-container>
    <ng-container *ngIf="segment == 6">
      <div style="display: -webkit-box;display: -webkit-inline-box;">
        <claims-list [CaseID]="CaseID" [claims]="Case?.claims" [isEditMode]="isEditMode"></claims-list>
      </div>
    </ng-container>
    <ng-container *ngIf="segment == 7">
      <ion-content class="overflow-auto">
        <case-tasks-list [CaseID]="CaseID"></case-tasks-list>
      </ion-content>
    </ng-container>
    <ng-container *ngIf="segment == 8">
      <charges-list [CaseID]="CaseID"></charges-list>
    </ng-container>



  </div>
</ng-container>





<div mat-row class="w-full my-4 text-2xl text-center" *ngIf="isLoading">
  <mat-spinner class="mx-auto" diameter='24'></mat-spinner>
</div>